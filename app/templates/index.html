
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Hwang Store - Trang chá»§</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .product-img {
      height: 300px;
      object-fit: cover;
    }
  </style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container">
    <a class="navbar-brand" href="{{ url_for('home') }}">Hwang Store</a>
    <a href="{{ url_for('cart') }}" class="btn btn-outline-light ms-auto position-relative" id="cart-icon">
      ğŸ›’ Giá» hÃ ng
      {% if session.get('cart') %}
      <span class="badge bg-danger">{{ session['cart']|length }}</span>
      {% endif %}
    </a>
  </div>
</nav>

<div id="mainBanner" class="carousel slide mb-4" data-bs-ride="carousel">
  <div class="carousel-inner">
    <div class="carousel-item active">
      <img src="{{ url_for('static', filename='images/mock0.jpg') }}" class="d-block w-100"
           style="max-height: 420px; object-fit: cover;" alt="Banner 1">
    </div>
    <div class="carousel-item">
      <img src="{{ url_for('static', filename='images/moisturizer.jpg') }}" class="d-block w-100"
           style="max-height: 420px; object-fit: cover;" alt="Banner 2">
    </div>
    <div class="carousel-item">
      <img src="{{ url_for('static', filename='images/mock2.jpg') }}" class="d-block w-100"
           style="max-height: 420px; object-fit: cover;" alt="Banner 3">
    </div>
  </div>
  <button class="carousel-control-prev" type="button" data-bs-target="#mainBanner" data-bs-slide="prev">
    <span class="carousel-control-prev-icon"></span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#mainBanner" data-bs-slide="next">
    <span class="carousel-control-next-icon"></span>
  </button>
</div>

<div class="container py-5">
  <h1 class="mb-4">ğŸ› Sáº£n pháº©m má»›i</h1>
  <div class="row g-4">
    {% for p in products %}
    <div class="col-md-4 col-sm-6">
      <div class="card h-100">


<!-- THÃŠM DÃ’NG NÃ€Y Ä‘á»ƒ kiá»ƒm tra -->
<img src="{{ url_for('static', filename='images/' + (p.image_url or 'placeholder.jpg')) }}"
     onerror="this.src='/static/images/placeholder.jpg'"
     class="card-img-top" alt="{{ p.name }}">





        <div class="card-body d-flex flex-column">
          <h5 class="card-title">{{ p['name'] }}</h5>
          {% if p['sale_price'] and p['sale_price'] < p['price'] %}
            <p class="card-text">
              <span class="text-muted text-decoration-line-through">{{ p['price'] }} VND</span><br>
              <span class="text-danger fw-bold">{{ p['sale_price'] }} VND</span>
            </p>
          {% else %}
            <p class="text-danger fw-bold">{{ p['price']|currency }} VND</p>
          {% endif %}
          <div class="mt-auto d-flex flex-wrap gap-2">
            <button class="btn btn-outline-success btn-sm add-to-cart-btn" data-id="{{ p['id'] }}">ğŸ›’ ThÃªm</button>
           <form method="POST" action="{{ url_for('add_to_cart', product_id=p['id']) }}">
  <input type="hidden" name="quantity" value="1">
  <input type="hidden" name="redirect" value="checkout">
  <button type="submit" class="btn btn-primary btn-sm">ğŸ›’ Äáº·t hÃ ng</button>
</form>
            <a href="{{ url_for('product_detail', product_id=p['id']) }}" class="btn btn-secondary btn-sm">Chi tiáº¿t</a>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>

  <nav aria-label="Page navigation">
    <ul class="pagination justify-content-center mt-4">
      {% if page > 1 %}
      <li class="page-item">
        <a class="page-link" href="{{ url_for('home', page=page - 1) }}">â† Trang trÆ°á»›c</a>
      </li>
      {% endif %}
      {% for p in range(1, total_pages + 1) %}
      <li class="page-item {% if p == page %}active{% endif %}">
        <a class="page-link" href="{{ url_for('home', page=p) }}">{{ p }}</a>
      </li>
      {% endfor %}
      {% if page < total_pages %}
      <li class="page-item">
        <a class="page-link" href="{{ url_for('home', page=page + 1) }}">Trang sau â†’</a>
      </li>
      {% endif %}
    </ul>
  </nav>
</div>

<script>
document.querySelectorAll('.add-to-cart-btn').forEach(button => {
  button.addEventListener('click', function () {

    const productId = this.dataset.id;
    const img = document.getElementById('product-img-' + productId);
    const cartIcon = document.getElementById('cart-icon');
    const url = `/add-to-cart/${productId}`;

    const clone = img.cloneNode(true);
    const rect = img.getBoundingClientRect();
    clone.style.position = 'fixed';
    clone.style.left = rect.left + 'px';
    clone.style.top = rect.top + 'px';
    clone.style.width = img.offsetWidth + 'px';
    clone.style.height = img.offsetHeight + 'px';
    clone.style.transition = 'all 0.8s ease-in-out';
    clone.style.zIndex = 1000;
    document.body.appendChild(clone);

    const cartRect = cartIcon.getBoundingClientRect();

    fetch(url, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
        'X-Requested-With': 'XMLHttpRequest'
      },
      body: 'quantity=1'
    }).then(res => {
      if (res.ok) {
        clone.style.left = cartRect.left + 'px';
        clone.style.top = cartRect.top + 'px';
        clone.style.opacity = 0.5;
        clone.style.transform = 'scale(0.2)';
        setTimeout(() => {
          clone.remove();
          const badge = cartIcon.querySelector('.badge');
          if (badge) {
            badge.innerText = parseInt(badge.innerText || '0') + 1;
          } else {
            const span = document.createElement('span');
            span.className = 'badge bg-danger';
            span.innerText = '1';
            cartIcon.appendChild(span);
          }
        }, 800);
      }
    });
  });
});
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<footer class="bg-dark text-white mt-5 pt-4 pb-2">
  <div class="container">
    <div class="row">
      <div class="col-md-4 mb-4">
        <h5>ğŸ› IRENNA STORE</h5>
        <p>Sáº£n pháº©m chÃ­nh hÃ£ng, tÆ° váº¥n táº­n tÃ¢m. Mua hÃ ng an tÃ¢m, nháº­n hÃ ng thanh toÃ¡n.</p>
      </div>
      <div class="col-md-4 mb-4">
        <h5>ğŸ“ Báº£n Ä‘á»“ cá»­a hÃ ng</h5>
        <div class="ratio ratio-4x3">
          <iframe
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3724.0289912530436!2d105.77963037590504!3d21.03059748061673!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3135ab468795d7e1%3A0xa3a25a03d64f98b1!2zVGjhuqFuaCBOZ3V54buFbiBU4burIFRow6BuaCBUcnVuZw!5e0!3m2!1svi!2s!4v1713943000000!5m2!1svi!2s"
            width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"></iframe>
        </div>
      </div>
      <div class="col-md-4 mb-4">
        <h5>ğŸ“ LiÃªn há»‡</h5>
        <ul class="list-unstyled">
          <li>Hotline: 0868 601 796</li>
          <li>Email: irenna@gmail.com</li>
          <li>Äá»‹a chá»‰: ÄÃ´ng Anh, HÃ  Ná»™i</li>
        </ul>
      </div>
    </div>
    <hr class="border-light">
    <p class="text-center mb-0">Â© 2025 HWANG STORE. All rights reserved.</p>
  </div>
</footer>
</body>
</html>
