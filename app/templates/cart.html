<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Giá» hÃ ng</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container">
    <a class="navbar-brand" href="{{ url_for('home') }}">IRENNA.COM</a>
  </div>
</nav>

<div class="container mt-5">
  <h2 class="mb-4">ğŸ›’ Giá» hÃ ng cá»§a báº¡n</h2>

  {% if cart_items %}
  <table class="table table-bordered align-middle">
    <thead class="table-light">
      <tr>
        <th>áº¢nh</th>
        <th>Sáº£n pháº©m</th>
        <th>ÄÆ¡n giÃ¡</th>
        <th>Sá»‘ lÆ°á»£ng</th>
        <th>ThÃ nh tiá»n</th>
        <th>XoÃ¡</th>
      </tr>
    </thead>
    <tbody>
      {% set total = 0 %}
      {% for item in cart_items %}
      <tr>
        <td><img src="{{ url_for('static', filename='images/' + item.image_url) }}" width="60" class="img-thumbnail"></td>
        <td>{{ item.name }}</td>
        <td>{{ item.price|currency  }}â‚«</td>
        <td><input type="number"
       class="form-control form-control-sm quantity-input"
       data-id="{{ item.id }}"
       value="{{ item.quantity }}"
       min="1"
       style="width: 80px;">
</td>
        <td>{{ (item.price * item.quantity)|currency }}â‚«</td>
        <td>
          <form action="{{ url_for('remove_from_cart', product_id=item.id) }}" method="POST">
            <button type="submit" class="btn btn-sm btn-danger">X</button>
          </form>
        </td>
      </tr>
      {% set total = total + (item.price * item.quantity) %}
      {% endfor %}
    </tbody>
    <tfoot>
  <tr>
    <td colspan="4" class="text-end"><strong>Tá»•ng cá»™ng:</strong></td>
    <td colspan="2"><strong>{{ total_price|currency}}â‚«</strong></td>
  </tr>
</tfoot>
  </table>

  <a href="{{ url_for('home') }}" class="btn btn-outline-secondary">â† Tiáº¿p tá»¥c mua</a>
  <a href="/checkout-page" class="btn btn-success float-end">ğŸ§¾ Thanh toÃ¡n</a>

  {% else %}
    <div class="alert alert-warning">Giá» hÃ ng cá»§a báº¡n Ä‘ang trá»‘ng.</div>
  {% endif %}
</div>
<footer class="bg-dark text-white mt-5 pt-4 pb-2">
  <div class="container">
    <div class="row">
      <div class="col-md-4 mb-4">
        <h5>ğŸ› IRENNA STORE</h5>
        <p>Sáº£n pháº©m chÃ­nh hÃ£ng, tÆ° váº¥n táº­n tÃ¢m. Mua hÃ ng an tÃ¢m, nháº­n hÃ ng thanh toÃ¡n.</p>
      </div>
      <div class="col-md-4 mb-4">
        <h5>ğŸ“ Báº£n Ä‘á»“ cá»­a hÃ ng</h5>
        <div class="ratio ratio-4x3">
          <iframe src="https://www.google.com/maps/embed?pb=..."
                  width="100%" height="100%" style="border:0;" allowfullscreen=""
                  loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
        </div>
      </div>
      <div class="col-md-4 mb-4">
        <h5>ğŸ“ LiÃªn há»‡</h5>
        <ul class="list-unstyled">
          <li>Hotline: 0868 601 796</li>
          <li>Email: irenna@gmail.com</li>
          <li>Äá»‹a chá»‰: ÄÃ´ng Anh, HÃ  Ná»™i</li>
        </ul>
      </div>
    </div>
    <hr class="border-light">
    <p class="text-center mb-0">Â© 2025 HWANG STORE. All rights reserved.</p>
  </div>
</footer>
<script>
document.querySelectorAll('.quantity-input').forEach(input => {
  input.addEventListener('change', function () {
    const productId = this.dataset.id;
    const quantity = this.value;

    fetch(`/update-cart/${productId}`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
        'X-Requested-With': 'XMLHttpRequest'
      },
      body: 'quantity=' + encodeURIComponent(quantity)
    }).then(res => {
      if (res.ok) {
        // Sau khi cáº­p nháº­t thÃ nh cÃ´ng, reload láº¡i Ä‘á»ƒ hiá»ƒn thá»‹ tá»•ng tiá»n
        location.reload();
      }
    });
  });
});
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
